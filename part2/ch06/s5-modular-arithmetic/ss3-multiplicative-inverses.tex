% !TeX root = ../../../book.tex

\subsection{乘法逆元}\label{sec:section6.5.3}

我们之前在证明模算数引理（引理 \ref{lemma6.5.10}）时提到过，不会在 $\mathbb{Z}$ 模 $n$ 的背景下讨论``除法''。本节中，我们将重新探讨这个想法，并解释为什么（以及如何）在某些特定情况下``除法''是合理的。然而，我们要强调的是，我们实际上在讨论一个更广泛的\textbf{乘法逆元}的概念，而\textbf{不是}真正的``除法''。我们将首先通过几个启发性例子来解释这一点，然后我们将陈述并证明这些特定情况下的具体结果。

\subsubsection*{整体概念}

给定一个特定的数学对象，它的\textbf{乘法逆元}是另一个对象，当我们将这两个对象``相乘''时，结果为 ``$1$''。这里我们加上引号是因为``相乘''和 ``$1$'' 的含义在不同的语境中可能会有很大差异。\\

\begin{example}
    让我们先考虑一个熟悉的例子。假设我们讨论的是实数集 $\mathbb{R}$，且使用通常的乘法运算。现在我们取数字 $2$。它的乘法逆元是什么？也就是说，是否存在另一个实数 $x$ 使得 $2 \cdot x = 1$？如果存在，它是多少？很明显，$x = \frac{1}{2}$ 是符合要求的！可以注意到 $2 \cdot \frac{1}{2} = 1$。出于这个原因，我们可以写出
    \[2^{-1} = \frac{1}{2} \quad \text{在 }\; \mathbb{R} \;\text{范围内}\]
    当我们把方程两边同时除以 $2$ 时，实际上是在把方程的两边都\emph{乘以} $2$ 的\emph{乘法逆元}。
\end{example}

\begin{example}
    现在让我们考虑一个可能不太熟悉的例子。想象一个挂钟，钟面上有均匀分布的 $12$ 个小时刻度标记。我们将考虑旋转挂钟，所以我们声明标准位置，即顶部 $12$ 点的位置为 ``$1$''。也就是说，这是没有进行额外旋转的标准表示法，所以我们称其为\emph{单位元}。实际上，我们的 ``$1$'' 就是指 ``$0 \degree$ 旋转'' 后的挂钟。

    现在，让我们假设将两个旋转``相乘''只是依次进行旋转。例如，我们先将时钟顺时针旋转 $45 \degree$，然后再顺时针旋转 $90 \degree$。在这个例子中，我们实际上是将 ``$45 \degree$ 旋转'' 和 ``$90 \degree$ 旋转'' \emph{乘}在一起，结果得到 ``$135 \degree$ 旋转''。

    建立这些约定的目的是为了明确我们的上下文、对象、``相乘''的含义以及``1''的定义，从而能够识别任意旋转的\emph{乘法逆元}。如果你仔细想一下，就会发现如果我们将 ``$\theta$ 度旋转'' 与 ``$360-\theta$ 度旋转'' 相乘，那么我们实际上是将时钟旋转了 $360 \degree$，并回到了标准位置，这正是我们在这个上下文中的 ``$1$''。这意味着，在我们当前上下文中
    \[(\theta \;\text{度旋转})^-1 = 360-\theta \;\text{度旋转}\]
\end{example}

这两个例子旨在说明，\emph{逆元}的概念是一个普遍的概念，并不局限于数字\emph{除法}这种标准上下文。事实上，当我们讨论\emph{函数的逆}时，也会看到类似的例子。（在这个上下文中，``相乘''指的是函数的复合，``$1$'' 是指恒等函数。虽然具体内容会在下一章详细介绍，但我们现在提到这一点，是为了让已经熟悉这些概念的读者有一个预先的理解。）

\subsubsection*{互质}

你可能已经熟悉以下定义。我们将在后续的结果中用到它，这个结果将说明在 $\mathbb{Z}$ 模 $n$ 的情况下何时存在乘法逆元，因此我们现在想重申这个定义并展示一些例子。

\begin{definition}
    给定 $x,y \in \mathbb{Z}$，我们说 $x$ 和 $y$ \dotuline{互质}当且仅当它们没有除 $1$ 以外的公因子。
\end{definition}

（\textbf{注意}：``互质'' 表示 $x$ 和 $y$ 彼此互质，并不是说 $x$ ``类似质数''或其他意思。）\\

\begin{example}
    例如，$12$ 和 $35$ 互质，因为 $12 = 2^2 \cdot 3$，而 $35 = 5 \cdot 7$，因此它们没有任何公因数。

    通常，写出\emph{质因数分解}是有帮助的，因为我们实际上是想知道两个数是否有共同的质因数（这意味着它们有公因数）。

    举个反例，$12$ 和 $33$ 不互质，因为 $3 \mid 12$ 且 $3 \mid 33$。
\end{example}

\begin{example}
    这个例子陈述的结果在后面会很有用。

    \textbf{声明}：如果 $p$ 是质数且 $a$ 不是 $p$ 的倍数，那么 $p$ 和 $a$ 互质。

    （也就是说，如果 $p$ 是质数且 $p \nmid a$，则 $p$ 和 $a$ 互质。）

    让我们来看看为什么这是正确的！

    \begin{proof}
        设 $p$ 为质数且 $a \in \mathbb{Z}$。假设 $p \nmid a$。

        由于 $p \nmid a$，所以 $a$ 的质因数中不包含 $p$。因为 $p$ 是质数，因此 $a$ 的质因数也不会整除 $p$。这意味着 $a$ 和 $p$ 没有共同的质因数，因此它们互质。
    \end{proof}

    这非常方便！特别是，我们现在知道，只要 $p$ 是质数，那么\textbf{所有}数字 $1, 2, 3, \dots , p-1$ 都与 $p$ 互质。
\end{example}

\subsubsection*{定义与示例}

我们来讨论一下在 $\mathbb{Z}$ 模 $n$ 的情况下，什么是\emph{乘法逆元}。这里的``乘法''指的是常规乘法，但所有结果都要模 $n$。另外，``$1$'' 实际上是对应于 $1$ 的\emph{等价类}。在这种情况下，我们说对于任意 $x \in \mathbb{Z}$，当且仅当 $xy \equiv 1 \mod n$ 时，$x$ 的乘法逆元（记作 $x^{-1}$）等于 $y$。也就是说：
\[\forall x \in \mathbb{Z} \centerdot \forall y \in \mathbb{Z} \centerdot y \equiv x^{-1} \mod n \iff xy \equiv 1 \mod n\]
请注意，这些声明都是在 $\mathbb{Z}$ 模 $n$ 的情况下进行的，因此我们不会写 ``$y = x^{-1}$''。数字 $x$ 表示一个等价类，$x^{-1}$ 也是如此。

让我们来练习一下如何\emph{找到}这些乘法逆元，或者判断它们何时不存在。关键在于以下几点：
\begin{quotation}
    如果 $x \cdot y \equiv 1 \mod n$，则对于所有 $k \in \mathbb{Z}, x \cdot (y+kn) \equiv 1 \mod n$
\end{quotation}
要想理解其中的原因，我们可以将右边表达式中的 $x$ 利用分配律展开：
\[x \cdot (y+kn) \equiv xy+xkn \equiv xy+n(xk) \equiv xy+0 \equiv xy \equiv 1 \mod n\]
也就是说，在展开过程中，给 $y$ 加上 $n$ 的倍数只会得到 $n$ 的倍数，而我们在模 $n$ 时可以``忽略''这些倍数。

由此我们可以得出以下结论：\textbf{如果} $x$ 在模 $n$ 下有一个乘法逆元，\textbf{那么} 
\begin{enumerate}[label=(\alph*)]
    \item 存在\emph{无穷多}个这样的逆元，并且它们都属于同一个模 $n$ 的等价类；
    \item 但是在集合 $\{1, 2, 3, \dots , n-1\}$ 中，我们可以找到\emph{唯一一个}这样的逆元。
\end{enumerate}

这些事实非常有趣且实用。特别是，它告诉我们无需进行复杂的存在性论证来寻找乘法逆元：只需逐一检查每种情况，直到找到一个。如果找不到，就说明不存在。换句话说，我们不必凭直觉臆断或随意猜测，而是有一个更为系统的猜测和检查算法。

让我们通过下面的例子来看看它在实际中的应用。\\

\begin{example}
    在这个例子中，我们会给出一个 $n \in \mathbb{N}$ 和一个 $x \in \mathbb{Z}$，然后寻找一个满足 $y \equiv x^{-1} \mod n$ 的 $y$。如果这样的逆元不存在，我们将说明原因。
    \begin{itemize}
        \item $\mathbf{n=3, x=2}$：\\
            我们只需检查 $y = 1$ 和 $y = 2$。注意到 $2 \cdot 2 \equiv 4 \equiv 1 \mod 3$，所以
            \[2^{-1} \equiv 2 \mod 3\]
        \item $\mathbf{n=4, x=3}$：\\
            我们只需检查 $y = 1, y = 2, y = 3$。注意到 $3 \cdot 3 \equiv 9 \equiv 1 \mod 4$，所以
            \[3^{-1} \equiv 3 \mod 4\]
        \item $\mathbf{n=4, x=2}$：\\
            我们只需检查 $y = 1$ 和 $y = 2$。然而，由于 $x$ 是偶数，所以 $x$ 的任何倍数也都是偶数，而满足 $y \equiv 1 \mod 4$ 的数必须是奇数。因此，$2$ 在模 $4$ 下没有乘法逆元。
        \item $\mathbf{n=10, x=3}$：\\
            我们可以在这里逐一检查所有情况：
            \begin{align*}
                3 \cdot 1 &\equiv 3 \mod 10 \\
                3 \cdot 2 &\equiv 6 \mod 10 \\
                3 \cdot 3 &\equiv 9 \mod 10 \\
                3 \cdot 4 \equiv 12 &\equiv 2 \mod 10 \\
                3 \cdot 5 \equiv 15 &\equiv 5 \mod 10 \\
                3 \cdot 6 \equiv 18 &\equiv 8 \mod 10 \\
                3 \cdot 7 \equiv 21 &\equiv 1 \mod 10 \\
            \end{align*}
            这意味着
            \[3^{-1} \equiv 7 \mod 10\]
            注意，这也同时表明
            \[7^{-1} \equiv 3 \mod 10\]
            因为乘法具有交换律（即顺序不重要）。这一观察使我们得出以下结论：
            \[(a^{-1})^{-1} \equiv a \mod n \quad \text{假设}\; a^{-1} \;\text{存在}\]
        \item $\mathbf{n=15, x=7}$：\\
            如果我们检查 $7$ 的所有倍数，会发现当我们检查到 $13$ 时，我们就成功了：
            \[7 \cdot 13 \equiv 91 \equiv 6 \cdot 15 + 1 ≡ 1 \mod 15\]
            所以
            \[7^{-1} \equiv 13 \mod 15\]
            验证工作留给你来完成。例如在模 $15$ 下 $6$ 没有乘法逆元。 
    \end{itemize}
\end{example}

\subsubsection*{何时存在乘法逆元？}

现在我们已经研究了一些例子，是时候静下心来，描述所有乘法逆元存在的情况。以下引理描述了这些情况。

\begin{lemma}[互质时的乘法逆元引理或 MIRP 引理]\label{lemma6.5.24}
    假设 $n \in \mathbb{M}, a \in \mathbb{Z}$ 且 $n, a$ \dotuline{互质}。考虑同余式 $a \cdot x \equiv 1 \mod n$，那么存在解 $x \in \mathbb{Z}$，使得它满足该同余式。

    事实上，这个同余式有无穷多个解，并且它们都模 $n$ 同余。这意味着在集合 $[n - 1] = \{1, 2, ... , n-1\}$ 中恰好存在一个解。

    我们用 $a^{-1}$ 来表示该同余方程解的等价类，并称其为 $a$ 模 $n$ 的\dotuline{乘法逆元}。

    此外，这是一个充要条件；也就是说，如果 $a$ 和 $n$ 不互质，那么同余方程 $a \cdot x \equiv 1 \mod n$ 在整数范围内无解。
\end{lemma}

这个引理完全说明了乘法逆元何时存在，何时不存在。我们可以用它来判断如下同余式
\[15x \equiv 1 \mod 33\]
在 $x \in \mathbb{Z}$ 下\textbf{误解}，因为 $3 \mid 15$ 且 $3 \mid 33$，所以它们不是互质的。同理，我们可以用它来判断如下同余式
\[40x \equiv 1 \mod 51\]
在 $x \in \mathbb{Z}$ 下\textbf{必}有解，因为 $40 = 2^3 \cdot 5$ 和 $51 = 3 \cdot 17$ 互质。（注意，这个引理在帮助我们\emph{找到}解时只提供了一部分信息；它只是保证我们可以在 $\{1, 2, \dots , n-1\}$ 的元素中找到解。）

为了\textbf{证明}这个引理，我们将其分成两部分，因为它是一个双向陈述。我们将为你证明其中一个方向；即当 $a$ 和 $n$ 互质时，$a^{-1}$ 在模 $n$ 下存在。另一个方向（如果 $a$ 和 $n$ 有公因子，那么 $a^{-1}$ 在模 $n$ 下不存在）将会在习题 \ref{exc:exercises6.7.21} 中引导你完成证明。（你可以现在就试试！）在证明过程中，我们需要用到以下有用的引理。

\begin{lemma}[欧几里得引理]\label{lemma6.5.25}
    给定 $a, b, c \in \mathbb{Z}$。假设 $a \mid bc$，并假设 $a$ 和 $b$ 互质。则 $a \mid c$。
\end{lemma}

我们会推迟对这个引理的证明，直到看到 MIRP 引理的证明。我们认为，详细探讨这个引理的证明细节可能会暂时分散我们对本节主要目标的注意力。此外，欧几里得引理的结果本身已经相当可信，我们可以暂时假定其有效性，并在 MIRP 引理的证明中使用它。请看以下几个例子：
\begin{itemize}
    \item 我们知道 $3 \mid 30$，且 $30 = 5 \cdot 6$。由于 $3$ 和 $5$ 互质，我们可以推断 $3 \mid 6$，而这当然是对的。
    \item 假设对于某个整数 $x, 3 \mid 5x$。我们能得出关于 $x$ 的什么结论呢？由于 $3$ 和 $5$ 互质，所以要使 $5x$ 成为 $3$ 的倍数，$x$ 必须``包含''一个 $3$ 的因子。也就是说，$3 \mid x$ 是必要条件。
\end{itemize}
我们意识到这还不够令人满意！我们并不是说要在没有证据的情况下\emph{接受}这个说法；我们只是希望在深入讨论之前稍等片刻。同时，你可以试着自己证明一下！看看你能得出什么结论。

现在，让我们继续向前，证明 MIRP 引理（假设在中间某个步骤会用到欧几里得引理的结果）。

\begin{proof}
    设 $n \in \mathbb{N}, a \in \mathbb{Z}$。假设 $a$ 和 $n$ \textbf{互质}。
    
    我们要证明 $\exists x \in \mathbb{Z} \centerdot ax \equiv 1 \mod n$。

    考虑 $a$ 的前 $n$ 个倍数组成的集合；也就是说，定义集合 $N$ 为
    \begin{align*}
        N &= \{0, a, 2a, 3a, \dots ,(n-1)a\} \\
        &= \{z \in \mathbb{Z} \mid \exists k \in [n - 1] \cup \{0\} \centerdot z = ka\}
    \end{align*}
    请注意，集合 $N$ 中有 $n$ 个元素。

    \textbf{声明}：集合 $N$ 的所有元素在模 $n$ 运算下会产生\emph{不同}余数；也就是说，
    \[\forall i, j \in [n-1] \cup \{0\} \centerdot i \ne j \implies ai \not\equiv aj \mod n\]

    我们来证明这个声明。首先，为了引出矛盾而假设该声明为\verb|假|。

    这意味着 $\exists i, j \in [n-1] \cup \{0\} \centerdot ai \equiv aj \mod n$。假设给定这样的 $i$ 和 $j$。

    通过减法和因式分解，我们可以得到 $ai - aj \equiv a(i-j) \equiv 0 \mod n$。

    这意味着 $n \mid a(i-j)$。已知 $n$ 和 $a$ 互质。根据上面的引理 \ref{lemma6.5.25}，我们可以推导出 $n \mid i-j$。

    现在，我们可以推断出 $i = j$。请记住 $i, j \in [n-1] \cup \{0\}$，因此 $0 \le i, j \le n-1$，也就是说 $-(n-1) \le -j, ij \le 0$。

    将这些关于 $i$ 和 $-j$ 的不等式相加后，我们可以发现
    \[-(n-1) + 0 = n-1 \le i + (-j) = i - j \le n - 1 = (n-1) + 0\]
    也就是说，$-(n-1) \le i-j \le n-1$。我们已知 $n \mid i - j$，即 $i-j$ 是 $n$ 的倍数。请注意，在 $-(n-1)$ 和 $+(n-1)$ 之间，$n$ 的倍数\emph{只有} $0$。

    因此 $i-j=0$，即 $i=j$。这就证明了当前的声明。

    我们现在可以确定，$N$ 的元素在模 $n$ 下会产生不同的余数。而且，这些可能的余数是 $\{0, 1, 2, \dots, n-1\} = [n-1] \cup \{0\}$。注意到 $N$ 有 $n$ 个不同的元素，而模 $n$ 下也有 $n$ 个不同的余数（等价类）。这意味着，在集合 $N$ 中，每个模 $n$ 的余数都\emph{恰好出现一次}。

    这表明，$N$ 中\emph{恰好}有一个元素（即一个 $a$ 的倍数）对应于模 $n$ 余数为 $1$。这个 $N$ 中的元素可以表示为 $ax$，其中 $x \in [n-1] \cup \{0\}$。假设给定这样的 $x$。这就是引理中所述同余方程的解。
\end{proof}

真是花了不少功夫，但我们终于到了这一步。既然你已经证明了练习 \ref{exc:exercises6.7.21} 中的论点（确实如此，对吧?$\smiley{}$），我们现在\emph{确切}知道在 $\mathbb{Z}$ 模 $n$ 的情况下，乘法逆元何时存在。我们也知道了一种合理的方法来找到它们：只需检查 $a$ 的前 $n-1$ 个倍数，找出其中模 $n$ 等于 $1$ 的倍数。

既然我们已经完成了这一步，现在让我们回头证明一下欧几里得引理。这一步是必要的，因为重要的 MIRP 引理的证明依赖于这个结果。注意，这个证明中包含一个复杂的\emph{归纳论证}。具体来说，我们有\emph{两个变量} $a$ 和 $b$，我们需要证明某个陈述对所有这样的 $a$ 和 $b$ 都成立。

\begin{proof}
    设 $a, b, c \in \mathbb{Z}$。假设 $a \mid bc$，且 $a$ 和 $b$ 互质。

    我们要证明必然有 $a \mid c$。我们先来证明：

    \textbf{声明}：如果 $a, b \in \mathbb{N}$ 且 $a$ 和 $b$ 互质，则 $\exists x, y \in \mathbb{Z} \centerdot ax+by = 1$。

    基于这个声明，结果将很容易得出。我们将这个声明的证明放在一个框中，方便阅读。在框之后，你会看到我们如何使用这个结果来证明引理的原始陈述。

    （在进行这个证明之前，可以先用一些例子来``说服''自己这个证明为\verb|真|。取两个互质的数，例如 $5$ 和 $11$，或者 $15$ 和 $22$，抑或 $10$ 和 $23$，尝试构造\emph{线性组合}来得到 $1$。然后，取一些有公因子的数，例如 $5$ 和 $10$，或者 $6$ 和 $15$，抑或 $21$ 和 $27$，尝试理解为什么你找不到这样的组合。）

    \begin{tcolorbox}[colback=gray!10,%gray background
        colframe=black,% black frame colour
        width=\textwidth,% Use 5cm total width,
        arc=2mm, auto outer arc,
        title={证明声明},breakable,enhanced jigsaw,
        before upper={\parindent15pt\noindent},	]
            我们将通过对 $a+b$ 进行归纳来证明这一点。在开始之前，先来看几个事实：
            \begin{itemize}
                \item 如果 $a=1$ 或 $a=-1$，则 $b$ 必须为 $0$ 或 $1$ 才能满足它们互质。\\
                    无论哪种情况，我们都可以令 $x=a, y=0$ 从而写出
                    \[ax + by = a^2 + 0 = 1\]
                    同样的论证亦可以应用于 $b=1$ 或 $b=-1$ 的情况（此时 $a$ 必为 $0$ 或 $1$）。
                \item 如果 $b=0$ 且 $|a| \ge 2$（即 $a \ne \pm 1$），则 $a, b$ 有公因子 $a$，因此它们不互质。\\
                    同样的论证亦可以应用于 $a=0$ 的情况。
            \end{itemize}
            综上，我们可以忽略 $a$ 或 $b$ 为 $0$ 的情况。换句话说，我们只考虑 $|a| \ge 1$ 和 $|b| \ge 1$ 的值。\\

            \begin{itemize}
                \item 因为 $a$ 和 $b$ 互质，所以 $-a$ 和 $b$ 也互质（同理，$-a$ 和 $b$ 以及 $a$ 和 $b$ 也都互质）。这是因为取相反数只会改变整数的符号，不会影响其因子。
                \item 如果已知 $\exists x, y \in \mathbb{Z} \centerdot ax + by = 1$，则必有
                    \[(-a)(-x) + (-b)(-y) = ax + by = 1\]
                    因为 $-x,-y \in \mathbb{Z}$，这说明 $-a$ 和 $-b$ 也可以有这样的表示。
            \end{itemize}
            综上，我们只需要考虑 $a$ 和 $b$ 为\emph{正数}的情况。（换句话说，如果 $a$ 或 $b$ 为负数，我们只需取它们的相反数即可。）\\

            结合之前的推论，我们可以推断出只需要考虑 $a,b \in \mathbb{N}$ 的情况。证明这些值的结果，再结合我们之前的观察，就能得出完整的结论。

            现在，我们可以通过对 $a + b$ 应用（强）归纳法来进行证明。由于 $a,b \in \mathbb{N}$，因此 $a + b \ge 2$。我们之前已经考虑了基本情况 $a + b = 2$，但为了完整性，这里再重述一遍。

            给定 $a,b \in \mathbb{N}$，定义 $P(a,b)$ 为陈述
            \[a \;\text{和}\; b \;\text{互质} \implies \exists x, y \in \mathbb{Z} \centerdot ax + by = 1\]

            \textbf{基本情况}：考虑 $P(2)$，即假设 $a,b \in \mathbb{N}$，$a$ 和 $b$ 互质且 $a+b=2$。这意味着 $a=b=1$，我们可以令 $x=1, y=0$ 得出
            \[ax + by = 1 + 0 = 1\]
            因此，$P(2)$ 成立。

            \textbf{归纳假设}：设 $k \in \mathbb{N}$ 为任意固定自然数。假设 $P(2) \land P(3) \land \dots \land P(k)$ 成立。（也就是说，假设每当两个互质数之和等于 $2,3, \dots, k$ 时，我们都能找到它们的一个\emph{线性组合}使其等于 $1$。）

            \textbf{归纳步骤}：我们要证明 $P(k+1)$ 成立。也就是说，设 $a, b \in \mathbb{N}$，且 $a + b = k + 1$，并假设 $a$ 和 $b$ 互质；我们要证明 $\exists x, y \in \mathbb{Z} \centerdot ax + by = 1$。

            首先，根据对称性，我们可以假设 $a \ge b$。（也就是说，给定 $a$ 和 $b$ 的值。无论它们是什么值，我们都可以对它们进行``重命名''，因为其中一个值至少与另一个一样大；我们将较大的那个标记为 $a$。）事实上，由于 $a$ 和 $a$ 不互质（当 $a \ge 2$ 时），我们甚至可以假设 $a > b$。

            现在，我们要利用 $b$ 和 $a - b$ 互质这一事实。要理解为什么会这样，我们需要证明 $b$ 和 $a - b$ 只有 $1$ 这个公约数。

            设 $d$ 为 $b$ 和 $a - b$ 的公因数，即 $d$ 能整除 $b$ 和 $a-b$。这意味着 $d$ 能整除 $b + (a-b)$，即 $d$ 能整除 $a$。我们已经知道 $d$ 能整除 $b$，因此 $d$ 实际上是 $a$ 和 $b$ 的公因数，所以它必然为 $1$。因此，$b$ 和 $a-b$ 互质。

            （我们刚刚证明的是
            \[(d \mid b \land d \mid a - b) \implies d \mid a \land d \mid b\]
            该声明也是一个 $\iff$ 陈述。我们鼓励你思考一下为什么 $\impliedby$ 方向也成立。）

            我们现在有 $b, a-b \in \mathbb{N}$（因为 $b < a$）互质。还要注意，$b + (a-b) = a < a + b = k + 1$，因为 $b \in \mathbb{N}$（所以 $b \ge 1$）。这意味着 $a + b \le k$，因此归纳假设 $P(a + b)$ 适用！

            （注意 $P(a + b)$ 不一定等同于 $P(k)$，因此我们需要使用强归纳法！）

            陈述 $P(a + b)$ --- 即 $P(b + (a - b))$，我们将用到这一点 --- 告诉我们 $b$ 和 $a - b$ 的线性组合可以得到 $1$；也就是说，
            \[\exists u, v \in \mathbb{Z} \centerdot ub + v(a - b) = 1\]
            我们现在要把它转换为 $a$ 和 $b$ 的线性组合，以得到 $1$。为此，我们将重新写这个方程，并重新标记系数：
            \[ub + v(a-b) = 1 \iff \underbrace{v}_{x} a + b \underbrace{(u - v)}_{y} = 1\]
            也就是说，我们现在可以定义 $x = v$ 和 $y = u - v$，这样 $x, y \in \mathbb{Z}$，并且满足 $ax + by = 1$。

            我们现在已经证明了 $P(a + b)$（即 $P(k + 1)$）成立。通过强归纳法，我们推导出 $P(n)$ 对于所有 $n \in \mathbb{N}$ 且 $n \ge 2$ 都成立。
    \end{tcolorbox}	

    为了提醒大家，这个证明的结果是，我们现在知道任意互质的数都可以通过线性组合得到 $1$。

    让我们回到引理的原始陈述。已知 $a, b, c \in \mathbb{N}$，并假设 $a$ 和 $b$ 互质且 $a \mid bc$。

    第一个假设说明存在整数 $x$ 和 $y$，使得 $ax + by = 1$。给定这样的 $x$ 和 $y$。

    第二个假设说明存在整数 $k$，使得 $bc = ak$。给定这样的 $k$。
    
    接下来，我们将第一个假设中的方程乘以 $c$，然后应用第二个假设：
    \[ax + by = 1 \implies acx + (bc)y = 1 \implies acx + (ak)y = c \implies c = a\underbrace{(cx + ky)}_{\ell}\]
    也就是说，通过 $ax + by = 1$，我们可以推导出 $c = a\ell$，其中 $\ell \in \mathbb{Z}$，并且 $\ell$ 是由其他整数定义的。

    根据定义，这意味着 $a \mid c$。这就证明了最初的陈述。
\end{proof}

哇！这个证明包含了很多内容。请你多读几遍，逐行理解并做好笔记。你能明白为什么每个声明都基于我们已知的内容吗？你能看出归纳法是如何应用的吗？虽然我们有两个变量，但我们对其中一个变量进行归纳，这个变量被定义为另外两个变量的和。我们知道这是一个复杂的证明，因此将它放在这里，紧跟在本节更重要的 MIRP 引理之后。

让我们利用这个结果 --- \emph{准确}知道何时存在乘法逆元 --- 来解决一系列问题吧！

\subsubsection*{使用乘法逆元}

这有何用处？虽然这个答案听起来有点调皮，但它确实是正确的：乘法逆元在使用模运算解决同余问题时非常有用。乍一看，似乎我们是为了这些问题而开发了数学工具，但事实并非如此。实际上，正如你将在接下来的例子中看到的那样，在尝试解决这些问题时，你很可能会发明出我们即将应用的这些技术。换句话说，即使你没有学过乘法逆元，也可以尝试解决这些问题，但最终你会重新发现我们已经探讨过的结果。

好了，铺垫就到这里。让我们看几个具体的问题。这些问题的形式都是：``有一个同余方程；找出该方程的所有整数解，或者证明其无解。''\\

\begin{example}\label{ex:example6.5.26}
    找到所有整数 $x, y \in \mathbb{Z}$ 满足
    \[3x - 7y = 11\]
    我们声称有无穷多对 $(x, y) \in \mathbb{Z} \times \mathbb{Z}$ 满足这个方程。此外，我们可以给出所有解的形式，并通过定义这些解的集合来实现。

    通过重写给定方程，我们想找出所有 $x \in \mathbb{Z}$ 使得
    \[3x \equiv 11 \mod 7\]
    假如我们能找到 $x \in \mathbb{Z}$ 所有整数解，我们可以轻松地通过解上面方程得到对应 $y \in \mathbb{Z}$ 的解：$y = \frac{3x-11}{7}$。

    注意到 $3^{-1} \equiv 5 \mod 7$，这是因为 $3 \cdot 5 \equiv 15 \equiv 2 \cdot 7 + 1 \equiv 1 \mod 7$。因此，根据模算术引理，我们可以将同余式两边乘以 $3^{-1}$，从而得到
    \begin{align*}
        \forall x \in \mathbb{Z} \centerdot 3x \equiv 11 \mod 7 &\iff 3^{-1} \cdot 3 \cdot x \equiv 3^{1}
\cdot 11 \mod 7 \\
        &\iff 1 \cdot x \equiv 5 \cdot 4 \mod 7 \\
        &\iff x \equiv 20 \equiv 6 \mod 7
    \end{align*}
    由于我们知道 $3^{-1}$ 表示这个同余式的所有解（即它代表 $3$ 模 $7$ 乘法逆元的等价类），那么我们可以推导出
    \[\forall x \in \mathbb{Z} \centerdot 3x \equiv 11 \mod 7 \iff x \equiv 6 \mod 7 \iff \exists k \in \mathbb{Z} \centerdot x = 7k + 6\]
    这表征了给定方程解中所有可能的 $x \in \mathbb{Z}$ 的值。

    现在，我们用这个方法来确定解中对应的 $y \in \mathbb{Z}$ 的值。假设 $k \in \mathbb{Z}$，且 $x = 7k + 6$，然后我们代入 $x$ 发现
    \[y = \frac{3x-11}{7} = \frac{3(7k + 6)-11}{7} = \frac{21k+7}{7} = 3k+1\]

    现在，我们找到了表示给定方程所有可能解的形式。我们知道，任意 $k \in \mathbb{Z}$ 都会对应一个 $x$，从而对应一个 $y$。此外，由于我们的推导使用了 $\iff$ 陈述，我们可以确定这涵盖了所有的解。

    我们可以将给定方程的解集 $S$ 描述为
    \[S = \{(x, y) \in \mathbb{Z} \times \mathbb{Z} \mid \exists k \in \mathbb{Z} \centerdot (x, y) = (7k + 6, 3k + 1)\}\]
\end{example}

\begin{tcolorbox}[colback=gray!10,
    colframe=black,
    width=\textwidth,
    arc=2mm, auto outer arc,
    title={有趣的事实},breakable,enhanced jigsaw,
    before upper={\parindent15pt\noindent},	]
    在这个例子中，我们解决了一个\textbf{线性丢番图方程}，并找出了它的所有解。所谓\emph{线性}，指的是变量 $x$ 和 $y$ 是一次的，没有平方或立方项。

    通过我们在这个例子中使用的技术，你可以解决\emph{任意}线性丢番图方程，或者轻松判别它是否有解。事实上，我们还将\emph{证明}一个关于这种方程何时没有解的结论（见贝祖恒等式，定理 \ref{theorem6.5.31}）。只要方程有解，这种方法就适用。
    
    在下一个例子中，我们将研究\textbf{二次丢番图方程}，其中变量会有平方项（包括 $x^2$ 和 $y^2$）。之后我们将讨论解决这类方程的可能性。
\end{tcolorbox}

\begin{example}
    现在让我们再来看一个例子，这个例子和前一个例子的过程类似（使用乘法逆元简化运算），但还引入了二次残差的概念。

    \textbf{声明}：无整数 $x, y \in \mathbb{Z}$ 满足方程
    \[3x^2-5y^2=1\]

    给定 $x, y \in \mathbb{Z}$。我们要证明 $3x^2-5y^2=1$ 是\emph{不可能的}。

    我们先将给定方程重写为
    \[3x^2 = 5y^2+1\]
    具体来说，这意味着
    \[3x^2 \equiv 1 \mod 5\]
    因为 $5y^2 \equiv 0 \mod 5$。注意到 $3^{-1} \equiv 2 \mod 5$，因为 $3 \cdot 2 = 6 = 5 + 1$。因此，我们可以将等式两边都乘以 $3^{-1}$，从而简化得：
    \[3x^2 \equiv 1 \mod 5 \iff 3^{-1} \cdot 3x^2 \equiv 3^{-1} \cdot 1 \mod 5 \iff x^2 \equiv 2 \mod 5\]
    然而，回顾示例 \ref{ex:example6.5.15}，在那里我们研究了\emph{二次残差}。我们发现，模 $5$ 的二次残差集合为 $\{0, 1, 4\}$。也就是说，\emph{不可能}有整数 $x$ 满足 $x^2 \equiv 2 \mod 5$。这就表明，给定方程没有整数解。
\end{example}

\begin{tcolorbox}[colback=gray!10,
    colframe=black,
    width=\textwidth,
    arc=2mm, auto outer arc,
    title={有趣的事实},breakable,enhanced jigsaw,
    before upper={\parindent15pt\noindent},	]
    我们之前提到，我们确切知道何时线性丢番图方程可解，并且知道如何解这些方程。但对于\textbf{二次丢番图方程}，我们就没有这么幸运了。要判断一个二次丢番图方程是否有解是非常困难的。即使知道它有解，实际求解也非常复杂。

    事实上，对于这些二次丢番图方程，我们的运气非常糟糕。已知\textbf{没有任何计算机算法可以输入带有一次和二次幂变量的丢番图方程，并判断该方程是否有解}。这一事实甚至不涉及如何解方程，仅仅是判断它是否有解。令人惊讶的是，这个事实是\href{https://en.wikipedia.org/wiki/Hilbert's_tenth_problem}{希尔伯特第十问题}的一种形式。

    请放心，我们在这里提供的例子和练习中的丢番图方程都可以用我们提供的技术进行分析。我们提到的这个事实是针对所有此类方程的一般性声明。
\end{tcolorbox}

\subsubsection*{一点群论知识}

在这一小节中，我们想强调当前主题背后蕴含的一些重要而深刻的数学原理。由于篇幅和时间所限，我们无法全面探讨这些内容。因此，我们将在此简要介绍一些概念和事实，并通过例子来加以说明。

我们想传达的主要思想是，当我们考虑 $\mathbb{Z}$ 模 $p$ 时（其中 $p$ 为\textbf{质数}），会出现一些特殊的现象。在这种情况下，每个小于 $p$ 的数都与 $p$ \emph{互质}，因为 $p$ 只有 $1$ 这个因子。这意味着在 $\{1, 2, \dots, p-1\}$ 中的所有数在模 $p$ 下都有乘法逆元。这非常方便，因为除了 $[0]_{\mod p}$ 外，每个同余类都有一个对应的乘法逆元类。

例如，考虑 $p=5$。注意到
\begin{align*}
    1^{-1} \equiv 1 \mod 5\\
    2^{-1} \equiv 3 \mod 5\\
    3^{-1} \equiv 2 \mod 5\\
    4^{-1} \equiv 4 \mod 5
\end{align*}

再比如，考虑 $p=7$。注意到
\begin{align*}
    1^{-1} \equiv 1 \mod 7\\
    2^{-1} \equiv 4 \mod 7\\
    3^{-1} \equiv 5 \mod 7\\
    4^{-1} \equiv 2 \mod 7\\
    5^{-1} \equiv 3 \mod 7\\
    6^{-1} \equiv 6 \mod 7
\end{align*}

请注意，这意味着集合中的所有元素都有一个乘法逆元。

（同时，请注意这些逆元其实是数字 $1$ 到 $p - 1$ 的一种\emph{排列}。这并非巧合！试着证明为什么会这样！试着证明有两个元素是它们自己的逆元，即 $1^{-1} \equiv 1 \mod p$ 和 $(p - 1)^{-1} \equiv p - 1 \mod p$，而其他元素都\emph{不可能}是它们自己的逆元。）

当我们考虑 $\mathbb{Z}$ 模 $n$ 时，如果 $n$ 是合数，情况就不一样了。这种情况下，我们知道 $n$ 可以因式分解；假设 $n = ab$，其中 $a,b \in \mathbb{N}-\{1\}$。那么 $1 < a < n$，但 $a$ 和 $n$ 不互质（它们有公因子 $a$），所以 $a$ 在模 $n$ 下没有乘法逆元。实际上，所有 $n$ 的因数（及其倍数）在模 $n$ 下都没有乘法逆元。

例如，考虑 $p=6$。
\begin{align*}
    1^{-1} \equiv 1 \mod 6\\
    2^{-1} \;\text{不存在} \mod 6\\
    3^{-1} \;\text{不存在} \mod 6\\
    4^{-1} \;\text{不存在} \mod 6\\
    5^{-1} \equiv 5 \mod 6
\end{align*}

由于这种区别，$\mathbb{Z}$ 模 $p$ 的数学``结构''显得格外突出。它具备一些优良的性质，并在某种意义上表现得非常好。虽然这些描述可能比较模糊，但主要思想是：所有元素都有逆元，这使得 $\mathbb{Z}$ 模 $p$ 很特别。事实上，$\mathbb{Z}$ 模 $p$ 构成一种称为\textbf{群}的数学结构。

一般来说，从启发式的角度看，群是一个可以进行``乘法''运算的对象集合，这种乘法运算满足
\begin{enumerate}[label=(\alph*)]
    \item 交换律
    \item 结合律
    \item 所有元素都有逆元
\end{enumerate}
我们已经知道，标准的整数乘法（即使在 $\mathbb{Z}$ 模 $n$ 中，对于任意 $n$）满足交换律和结合律，并且在 $\mathbb{Z}$ 模 $p$ 中（对于质数 $p$）每个元素都有逆元。

如果你对这些概念感兴趣，可以在本章末尾找到一些练习，帮助你理解这些性质。此外，你也可以查阅一些\textbf{抽象代数}、\textbf{近世代数}或\textbf{群论}的入门教材。这些领域中有许多强大而深刻的数学思想，\textbf{群}在许多领域中都有重要的应用！
