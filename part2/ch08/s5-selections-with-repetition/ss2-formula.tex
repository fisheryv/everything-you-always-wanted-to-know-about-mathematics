% !TeX root = ../../../book.tex

\subsection{公式}

我们将通过海盗分金币的例子来推导重复选择的公式。首先，解释为什么这与重复选择类似：

假设在这个场景中，我们是\emph{黄金分配者}。我们坐在一张桌子旁，周围坐着 $k$ 个海盗，旁边有一个装满 $n$ 个金币的袋子。我们可以选择如何一个一个地分配这些金币。当我们选择将一个金币分给某个编号为 $i$ 的海盗（$i \in [k]$）时，我们实际上是在 $k$ 个不同海盗中做选择。最终，要分配 $n$ 枚金币，我们需要进行 $n$ 次选择。因此，我们总共从 $k$ 种类型中选择 $n$ 个对象，并且允许重复选择。

\subsubsection*{推导}

想象一下，桌子上排着 $n$ 枚金币。为了在 $k$ 个海盗之间分配这些金币，我们需要将金币分成 $k$ 堆。然后，海盗 $1$ 拿走最左边的一堆，海盗 $2$ 拿走下一堆，依此类推。

通过``分割线''论证，我们可以方便地计算出完成这个过程的方法数！要将 $n$ 枚金币分配给 $k$ 个不同的海盗，需要用 $k - 1$ 个分隔线将 $n$ 枚金币分开。为什么只需要 $k - 1$ 个分隔线呢？想象一下，我们只需要 $1$ 个分隔线就可以把一排硬币分成两堆。同理，$2$ 个分隔线可以将硬币分成 $3$ 堆。一般来说，$k - 1$ 个分隔线，可以将金币分成 $k$ 堆，不需要在最右边再放一个分隔线来表示第 $k$ 个海盗的那堆。\\

\begin{example}
    例如，当 $k=3, n=7$ 时，我们可能会得到下面的分配方案：
    \[\circ \mid \circ \circ \circ \circ \mid \circ \circ\]
    这种情况下，海盗 $1$ 获得 $1$ 枚金币，海盗 $2$ 获得 $4$ 枚金币，海盗 $3$ 获得 $2$ 枚金币。

    需要注意的是，这种分配方案与下面的分配方案是\emph{不同的}：
    \[\circ \circ \circ \circ \mid \circ \circ \mid \circ\]
    这种情况下，海盗 $1$ 获得 $4$ 枚金币，海盗 $2$ 获得 $2$ 枚金币，海盗 $3$ 获得 $1$ 枚金币。

    我们也可以让某些海盗获得 $0$ 枚金币：
    \[\circ \circ \circ \circ \circ \mid \circ \circ \mid\]
    这种情况下，海盗 $1$ 获得 $5$ 枚金币，海盗 $2$ 获得 $2$ 枚金币，海盗 $3$ 获得 $0$ 枚金币。
\end{example}

这些观察结果告诉了我们什么呢？实际上，这意味着任何金币的分配方式都可以对应一个长度为 $n + k - 1$ 的字符串，其中包含 $n$ 个金币和 $k - 1$ 个分隔线。这两个对象（金币分配和分隔线位置）的集合之间存在\emph{双射}的关系。给定一个金币分配方案，我们可以构建出相应的分隔线排列。（例如，如果我们知道海盗 $1$ 得到 $5$ 枚金币，海盗 $2$ 得到 $2$ 枚金币，海盗 $3$ 得到 $0$ 枚金币，我们就可以构建出前面例子中的分隔线排列。）同理，给定一个分隔线排列，我们也可以从中得出对应的金币分配方案。

这种双射关系告诉我们，要计算金币分配方案的数量，只需要计算可能的分隔线排列数量。我们可以很容易地计算出这些排列的数量！一个分隔线排列就是一个长度为 $n + k - 1$ 的字符串，其中包含 $k - 1$ 个分隔线。这是因为我们需要 $n$ 个金币和 $k - 1$ 个分隔线，总共需要 $n + k - 1$ 个位置。因此，根据选择的定义，有
\[{n+k-1 \choose k-1}\]
种方法来构建这样的排列！

（你可能也听说过``星条''论证法。它只是这个问题的另一种常见解释，其中金币被替换成了星星，分隔线被替换成了长条。）

由于这些排列方式与金币分配方案之间存在双射关系，我们可以得出结论：${n+k-1 \choose k-1}$ 就是分配金币的方法数！

我们已经知道一般情况下 ${n \choose k} = {n \choose n-k}$，因此可以应用到这里，推导出金币分配方案的数量也等于
\[{n+k-1 \choose n}\]
实际上，我们在推导过程中已经看到了这个结论。我们需要构造一个长度为 $n+k-1$ 的字符串，其中 $k-1$ 个位置是分隔线（其余位置是金币）。换句话说，我们需要一个长度为 $n+k-1$ 的字符串，其中 $n$ 个位置是金币（其余位置是分隔线）。
