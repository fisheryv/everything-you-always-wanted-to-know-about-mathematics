% !TeX root = ../../../book.tex

\subsection{示例}

\begin{example}[桥牌]

    在桥牌中，每位玩家都会得到 $13$ 张牌。那么，有多少种牌型是每个花色至少一张牌呢？

    回想一下，在之前的扑克游戏中（$5$ 张手牌），这个问题很容易解决！我们只需注意到花色的分布必然为 \verb|1 1 1 2|，也就是说，有一个花色出现两次，其他花色各出现一次。（可以参考示例 \ref{ex:example8.3.6} 了解详细的论证过程。）

    但是，当我们处理 $13$ 张牌时，情况就复杂得多。我们需要考虑将 $13$ 张牌分成非零项的所有可能情况，例如$(1,1,1,10), (1,1,2,9),(1,2,3,7)$等等。这样的情况非常多！

    为了更高效地解决这个问题，我们可以使用容斥原理。

    设 $U$ 为全部 $13$ 张牌的集合。

    设 $A_H$ 为全部 $13$ 张牌\emph{都不是}红桃的集合

    设 $A_S$ 为全部 $13$ 张牌\emph{都不是}黑桃的集合

    设 $A_C$ 为全部 $13$ 张牌\emph{都不是}梅花的集合

    设 $A_D$ 为全部 $13$ 张牌\emph{都不是}方片的集合

    由此我们得到如下表达式
    \[\smiley{} = |U - (A_H \cup A_S \cup A_C \cup A_D)|\]
    考虑到所有可能的交集，我们得到
    \begin{align*}
        \smiley{} = & |U| - |A_H| - |A_S| - |A_C| - |A_D|                 \\
                    & + |A_H \cap A_S| + |A_H \cap A_C| + |A_H \cap A_D|  \\
                    & + |A_S \cap A_C| + |A_S \cap A_D| + |A_C \cap A_D|  \\
                    & - |A_H \cap A_S \cap A_C| - |A_H \cap A_S \cap A_D| \\
                    & - |A_S \cap A_C \cap A_D| - |A_H \cap A_D \cap A_C| \\
                    & + |A_H \cap A_S \cap A_C \cap A_D|
    \end{align*}
    由于存在 $4$ 个``不良集合''，我们需要考虑它们所有可能的交集方式。不过，计算这些交集其实很方便，因为交集的大小只取决于有多少个集合相交，而不取决于具体是哪些集合。

    要想得到一手没有某个花色的 $13$ 张牌，我们需要从其他花色的 $39$ 张排中选择 $13$ 张。因此 $|A_H| = |A_S| = |A_C| = |A_D| = {39 \choose 13}$。

    同理，要排除两种花色则有 $A_H \cap A_S = {26 \choose 13}$。这对任意两个集合的交集都成立。

    同理，要排除三种花色则有 $A_H \cap A_S \cap A_D = {13 \choose 13}$。这相当于从第四种花色中选择 $13$ 张牌。这对任意三个集合的交集都成立。

    因此，我们得到共有
    \[\smiley{} = {53 \choose 13}-{4 \choose 1}{39 \choose 13}+{4 \choose 2}{26 \choose 13}-{4 \choose 3}{13 \choose 13}+{4 \choose 4}{0 \choose 13}\]
    种牌型。

    （注意，最后一项是 $0$；怎么可能有一副 $13$ 张手牌却没有任何花色呢？！）

    \emph{一个启示}：注意我们在这个例子中是如何定义集合 $U$ 和 $A_i$ 的。我们想要计算具有某种特性的牌型数量，因此我们定义了不具有该特性的牌型集合，然后考虑如何从总数中减去这些集合的数量。
\end{example}

\begin{example}[满射计数]

    计算函数 $f:[5] \to [3]$ 的数量。计算其中单射的数量。计算其中满射的数量。

    设 $U$ 是从 $[5]$ 到 $[3]$ 的所有函数的集合。

    因为定义域中的每个元素都有 $3$ 个可能的输出，所以我们知道 $|U| = 3^5$。

    \emph{不存在}单射。如果一个函数 $f : [5] \to A$ 为单射，那么 $|\im_f ([5])| = 5$，但这里的值域大小为 $3$。因此，这是不可能的。

    让我们来算一下有多少满射！

    设 $A_1$ 为所有 $1 \notin \im_f ([5])$ 的函数的集合。

    设 $A_2$ 为所有 $2 \notin \im_f ([5])$ 的函数的集合。

    设 $A_3$ 为所有 $3 \notin \im_f ([5])$ 的函数的集合。

    则我们得到表达式 $N = |U - (A_1 \cup A_2 \cup A_3)|$。由此可得
    \[N = |U| - |A_1| - |A_2| - |A_3| + |A_1 \cap A_2| + |A_1 \cap A_3| + |A_2 \cap A_3| - |A_1 \cap A_2 \cap A_3|\]
    通常情况下，对于函数 $f : [m] \to [n]$，它的数量为 $n^m$（即对于 $m$ 个输入，每个输入都有 $n$ 种可能的输出），由此我们可得
    \[N=3^5-{3 \choose 1}2^5+{3 \choose 2}1^5-{3 \choose 3}0^5=3^5-3 \cdot 2^5 + 3 \cdot 1^5 - 0 = 243 - 96 + 3 = 150\]
\end{example}

\begin{example}
    找出 $1$ 到 $1000$ 之间既不是完全平方数也不是完全立方数也不是完全四次方数的自然数的个数。

    设 $U=[1000]$。对于 $i \in \{2,3,4\}$，设 $A_i$ 为 $U$ 中完全 $i$ 次方数的集合。也就是说，定义
    \[A_i = \{x \in U \mid \exists b \in \mathbb{N} \centerdot x = b^i\}\]
    则我们要求的值为 $N = |U - (A_2 \cup A_3 \cup A_4)|$。

    显然 $|U| = 1000$。

    易得，$U$ 中最大的完全平方数为 $31^2=961$（因为 $32^2 = 1024$），因此 $|A_2| = 31$。

    同理，$U$ 中最大的完全立方数为 $10^3=1000$，因此 $|A_3|=10$。

    同理，$U$ 中最大的完全四次方数为 $5^4=625$（因为 $6^4=1296$），因此 $|A_4|=5$。

    考虑交集的情况，不难发现，例如 $A_2 \cap A_3$ 是六次方数的集合，因为 $LCM(2,3)=6$。（$LCM$ 是\emph{最大公倍数 Least Common Multiple} 的缩写 ）。

    $U$ 中最大的完全六次方数为 $3^6 = 729$（因为 $4^6=4096$），因此 $|A_2 \cap A_3|=3$。

    我们已经找到了 $U$ 中最大四次方数为 $5^4$，所以 $|A_2 \cap A_4|=|A_4|=5$。

    $U$ 中最大的完全十二次方数为 $1^{12} = 1$（因为 $2^{12}=4096$），因此 $|A_3 \cap A_4|=1$。

    上面结果还告诉我们 $|A_2 \cap A_3 \cap A_4| = |A_3 \cap A_4|=1$。

    综上，我们得到
    \[N = 1000 - 31 - 10 - 5 + 3 + 5 + 1 - 1 = 962\]
\end{example}