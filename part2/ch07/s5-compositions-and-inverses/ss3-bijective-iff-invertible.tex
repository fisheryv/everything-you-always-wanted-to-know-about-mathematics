% !TeX root = ../../../book.tex

\subsection{双射 $\iff$ 可逆}

正如我们一直暗示的，双射函数必然存在逆函数。该命题的逆命题同样成立，因此我们可以完整陈述并证明这一``\emph{当且仅当}''命题。章节标题中的``\textbf{可逆}''通常指``具有反函数''。

\begin{theorem}
    设 $A, B$ 为任意集合。$f : A \to B$ 为函数。则
    \[f \text{\ 为双射} \iff f \textbf{\ 存在反函数\ } f^{-1}: B \to A\]
\end{theorem}

\begin{proof}
    ($\implies$) 假设 $f$ 为双射。这意味着 $f$ 即是单射又是满射。我们按如下规则定义 $f$ 的反函数 $g : B \to A$： 

    给定 $b \in B$。由 $f$ 是满射可知 
    \[\exists a \in A \centerdot f(a)=b\]

    给定这样的 $a$。由 $f$ 是单射可知
    \[\forall x \in A \centerdot x \ne a \implies f(x) \ne f(a) = b\]

    这表明 $a$ 是 $A$ 中\emph{唯一}满足 $f(a) = b$ 的元素。定义 $f(b) = a$，这是一个良好定义的函数。

    易得 $(f \circ g)(b) = f(g(b)) = f(a) = b$，所以 $f \circ g = \id_B$。

    并且 $(g \circ f)(a) = g(f(a)) = g(b) = a$，所以 $g \circ f = \id_A$。

    因此，$g = f^{-1}$，即 $f$ 可逆。\\

    ($\impliedby$) 假设 $f$ 有反函数 $f^{-1} : B \to A$。

    首先，证明 $f$ 为单射。给定 $a_1, a_2 \in A$，易得
    \begin{align*}
        f(a1) = f(a2) &\implies f^{-1}(f(a_1)) = f^{-1}(f(a_2)) & f^{-1}: B \to A \text{\ 为函数} \\
        &\implies (f^{-1} \circ f)(a_1) = (f^{-1} \circ f)(a_2) & \text{复合的定义} \\
        &\implies \id_A(a_1) = \id_A(a_2) & \textbf{恒等函数的定义} \\
        &\implies a_1 = a_2 & \textbf{恒等函数的定义} 
    \end{align*}

    因此 $f$ 为单射。

    接着，证明 $f$ 为满射。给定 $b \in B$。因为 $f^{-1}$ 为函数，因此 $\exists a \in A \centerdot f^{-1}(b)=a$。给定这样的 $a$，易得
    \begin{align*}
        f^{-1}(b) = a &\implies f(f^{-1}(b)) = f(a) & f : A \to B \text{\ 为函数} \\
        &\implies (f \circ f^{-1})(b) = f(a) & \text{复合的定义} \\
        &\implies \id_B(b) = f(a) & \textbf{恒等函数的定义} \\
        &\implies b = f(a) d& \textbf{恒等函数的定义} 
    \end{align*}

    因此 $f$ 为满射。
\end{proof}

\subsubsection*{证明函数为双射}

该定理提供了一种证明函数 $f : A \to B$ 为双射的新方法：无需分别证明 $f$ 是单射和满射，只需定义函数 $g : B \to A$ 并证明 $g$ 是 $f$ 的\textbf{反函数}（即 $g = f^{-1}$）。根据定理，即可推出 $f$ 为双射。在实际应用中，可以根据具体情况选择更便捷或更熟悉的策略。这两种方法均可行！

\subsubsection*{反函数的反函数}

以下推论直接源于上述定理。我们称之为推论而非新定理，是因为其结论未引入新内容——如证明所示，其本质是对原定理的应用。

\begin{corollary}
    设 $A, B$ 为任意集合。$f : A \to B$ 为函数。

    若 $f$ 为双射，则 $f^{-1}$ 存在且亦为双射。

    此外 $\left(f^{-1}\right)^{-1} = f$。
\end{corollary}

\begin{proof}
    假设 $f$ 有反函数 $f^{-1} : B \to A$。根据反函数的定义，这意味着 $f \circ f^{-1} = \id_B$ 且 $f^{-1} \circ f = \id_A$。

    再次通过反函数的定义，这些条件证明了 $(f^{-1})^{-1}=f$！这表明 $f^{-1}$ 有一个反函数（即 $f$ 本身），因此根据上面的定理可得 $f^{-1}$ 必为双射。
\end{proof}

\subsubsection*{复合函数的反函数}

在进入练习和下一节之前，让我们总结一下本章的核心内容。我们将在此陈述两个重要结论，其证明留作本章练习。完成这些证明将帮助你：
\begin{enumerate}[label=(\alph*)]
    \item 巩固对已有概念的理解，包括函数、映射、复合、反函数等；
    \item 获得关于如何定义复合函数的反函数的重要结论。
\end{enumerate}

\begin{proposition}
    设函数 $f : A \to B$ 和 $g : B \to C$ 为双射。定义复合函数 $h : A \to C$ 为 $h = g \circ f$。
    
    则 $h$ 也为双射。
\end{proposition}

\begin{proof}
    留作练习 \ref{exc:exercises7.8.9}。
\end{proof}

\begin{proposition}
    设函数 $f : A \to B$ 和 $g : B \to C$ 为双射。定义复合函数 $h : A \to C$ 为 $h = g \circ f$。
    
    则 $h$ 可逆，且 $h^{-1} = f^{-1} \circ g^{-1}$。
\end{proposition}

\begin{proof}
    留作练习 \ref{exc:exercises7.8.10}。
\end{proof}